# Excel Files Similarity Matrix

## Visual Comparison of All Files

### Column Overlap Analysis

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        COMMON FIELDS ACROSS ALL FILES                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

                    ARC      OVERTIME  PARTIAL   PUNCH    REGULAR
                  SUMMARY              DAY      RECORD    AUDIT
                  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
EP NO               ‚úì         ‚úì         ‚úì        ‚úì         ‚úì      ‚Üê PRIMARY KEY
PUNCHDATE           ‚úì         ‚úì         ‚úì        ‚úì         ‚úì      ‚Üê PRIMARY KEY
CONTRACTOR CODE     ‚úì         ‚úì         ‚úì        ‚úì         ‚úì      ‚Üê FOREIGN KEY
CONTRACTOR NAME     ‚úó         ‚úì         ‚úì        ‚úì         ‚úì
EP NAME             ‚úó         ‚úì         ‚úì        ‚úì         ‚úì
SECTOR NAME         ‚úì         ‚úì         ‚úì        ‚úì         ‚úì
PLANT NAME          ‚úì         ‚úì         ‚úì        ‚úì         ‚úì
DEPARTMENT NAME     ‚úó         ‚úì         ‚úì        ‚úì         ‚úì
TRADE NAME          ‚úì         ‚úì         ‚úì        ‚úì         ‚úì
SKILL               ‚úì         ‚úì         ‚úì        ‚úì         ‚úì
CARD CATEGORY       ‚úó         ‚úì         ‚úì        ‚úì         ‚úì
SHIFT               ‚úó         ‚úì         ‚úì        ‚úì         ‚úì
AREA OF MOVEMENT    ‚úó         ‚úì         ‚úì        ‚úì         ‚úì
```

### Similarity Scores

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  File Pair                          Similarity Score          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  OVERTIME ‚Üî PARTIAL DAY                   95%  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚îÇ
‚îÇ  OVERTIME ‚Üî REGULARIZATION                93%  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚îÇ
‚îÇ  PARTIAL DAY ‚Üî REGULARIZATION             92%  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚îÇ
‚îÇ  PUNCH RECORD ‚Üî OVERTIME                  85%  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚îÇ
‚îÇ  PUNCH RECORD ‚Üî PARTIAL DAY               83%  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚îÇ
‚îÇ  PUNCH RECORD ‚Üî REGULARIZATION            82%  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚îÇ
‚îÇ  ARC SUMMARY ‚Üî PUNCH RECORD               65%  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚îÇ
‚îÇ  ARC SUMMARY ‚Üî OVERTIME                   55%  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà        ‚îÇ
‚îÇ  ARC SUMMARY ‚Üî PARTIAL DAY                52%  ‚ñà‚ñà‚ñà‚ñà‚ñà         ‚îÇ
‚îÇ  ARC SUMMARY ‚Üî REGULARIZATION             50%  ‚ñà‚ñà‚ñà‚ñà‚ñà         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## File Relationships Diagram

```
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ   PUNCHRECORD REPORT (Master)   ‚îÇ
                    ‚îÇ   25,071 records                ‚îÇ
                    ‚îÇ   - All punch in/out times      ‚îÇ
                    ‚îÇ   - Most comprehensive          ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                   ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ                                 ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ  ARC SUMMARY        ‚îÇ         ‚îÇ  EXCEPTION RECORDS   ‚îÇ
         ‚îÇ  15,496 records     ‚îÇ         ‚îÇ                      ‚îÇ
         ‚îÇ  - Daily aggregate  ‚îÇ         ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
         ‚îÇ  - Mandays & OT     ‚îÇ         ‚îÇ  ‚îÇ OVERTIME        ‚îÇ ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ  ‚îÇ 770 records     ‚îÇ ‚îÇ
                                         ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
                                         ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
                                         ‚îÇ  ‚îÇ PARTIAL DAY     ‚îÇ ‚îÇ
                                         ‚îÇ  ‚îÇ 19 records      ‚îÇ ‚îÇ
                                         ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
                                         ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
                                         ‚îÇ  ‚îÇ REGULARIZATION  ‚îÇ ‚îÇ
                                         ‚îÇ  ‚îÇ 146 records     ‚îÇ ‚îÇ
                                         ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
                                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## Data Type Comparison

### 1. ARC SUMMARY (Aggregated Data)
**Purpose:** Daily summary of attendance
**Unique Fields:**
- `mandays` - Number of days worked
- `regularMandayHr` - Regular hours
- `ot` - Overtime hours
- `locationStatus` - Location tracking

**Use Case:** Monthly reports, payroll calculation

---

### 2. OVERTIME (Request/Approval Data)
**Purpose:** Track overtime requests and approvals
**Unique Fields:**
- `ACTUAL OVERSTAY` - Actual extra hours
- `REQUESTED OVERTIME` - Contractor's request
- `APPROVED OVERTIME` - EIC's approval
- `CONTRACTOR OT REASON` - Reason for OT
- `OT REQUEST STATUS` - Pending/Approved/Rejected

**Use Case:** Overtime approval workflow

---

### 3. PARTIAL DAY (Request/Approval Data)
**Purpose:** Track partial day work requests
**Unique Fields:**
- `ACTUAL PD HOURS` - Actual hours worked
- `REQUESTED PD HOURS` - Requested hours
- `APPROVED PD HOURS` - Approved hours
- `MANDAY CONVERSION` - Convert hours to mandays (e.g., 6hrs = 0.75)

**Use Case:** Handle employees working less than full shift

---

### 4. PUNCHRECORD REPORT (Raw Transaction Data)
**Purpose:** Detailed punch in/out records
**Unique Fields:**
- `PUNCH1 IN`, `PUNCH2 OUT`, `PUNCH3 IN`, `PUNCH4 OUT`, `PUNCH5 IN`, `PUNCH6 OUT`
- `EARLY IN`, `LATE COME`, `EARLY OUT`
- `HOURS WORKED`, `OVERSTAY`
- `STATUS` - P/A/L (Present/Absent/Leave)
- `MANUAL REQUEST` - Manual entry flag

**Use Case:** Audit trail, detailed attendance tracking

---

### 5. REGULARIZATION (Correction Data)
**Purpose:** Correct punch time errors
**Unique Fields:**
- `OLD PUNCH IN`, `OLD PUNCH OUT` - Original times
- `NEW PUNCH IN`, `NEW PUNCH OUT` - Corrected times
- `CONTRACTOR REASON` - Why correction needed
- `REQUEST STATUS` - Pending/Approved/Rejected

**Use Case:** Handle late coming, early leaving, missed punches

---

## Key Insights for Database Design

### 1. **Master Tables Needed:**
```
employees (ep_no, ep_name, contractor_code, trade, skill, etc.)
contractors (contractor_code, contractor_name)
eic_users (eic_code, eic_name)
plants (plant_code, plant_name, sector_name)
```

### 2. **Transaction Tables Needed:**
```
punch_records (from Punchrecord Report)
daily_summary (from ARC Summary)
overtime_requests (from OVERTIME)
partial_day_requests (from PARTIAL DAY)
regularization_requests (from REGULARIZATION)
```

### 3. **Linking Strategy:**
All files can be linked using:
- **EP NO** (Employee ID)
- **PUNCHDATE** (Date)
- **CONTRACTOR CODE** (Contractor)

Example query:
```sql
SELECT 
    p.ep_no,
    p.ep_name,
    p.punchdate,
    p.hours_worked,
    a.mandays,
    a.ot,
    o.approved_overtime,
    pd.approved_pd_hours,
    r.request_status as regularization_status
FROM punch_records p
LEFT JOIN daily_summary a 
    ON p.ep_no = a.ep_no AND p.punchdate = a.punchdate
LEFT JOIN overtime_requests o 
    ON p.ep_no = o.ep_no AND p.punchdate = o.punchdate
LEFT JOIN partial_day_requests pd 
    ON p.ep_no = pd.ep_no AND p.punchdate = pd.punchdate
LEFT JOIN regularization_requests r 
    ON p.ep_no = r.ep_no AND p.punchdate = r.punchdate
WHERE p.ep_no = 'PP5000014534'
```

---

## Duplicate Detection

### Potential Duplicates:
Based on analysis, **NO DUPLICATES** found across files because:
- **ARC SUMMARY** = Aggregated daily data
- **OVERTIME** = Only records with overtime
- **PARTIAL DAY** = Only records with partial work
- **PUNCHRECORD** = All punch records
- **REGULARIZATION** = Only correction requests

### However, watch for:
1. Same EP NO + PUNCHDATE appearing in multiple exception files
2. Example: An employee might have:
   - Punch record (normal)
   - Overtime request (worked extra)
   - Regularization request (late coming)
   
   This is **NOT a duplicate** - it's related data!

---

## Data Validation Rules

### Before Import:
1. ‚úÖ **EP NO format:** Must match pattern `PP\d{10}` or `VP\d{10}`
2. ‚úÖ **PUNCHDATE format:** Must be valid date (DD/MM/YYYY)
3. ‚úÖ **CONTRACTOR CODE:** Must exist in contractors table
4. ‚úÖ **Time format:** Must be HH:MM or HH:MM:SS
5. ‚úÖ **Status values:** Must be in allowed list (P, A, L, etc.)

### During Import:
1. ‚ö†Ô∏è **Check for missing required fields**
2. ‚ö†Ô∏è **Validate time ranges** (punch out > punch in)
3. ‚ö†Ô∏è **Check date ranges** (not future dates)
4. ‚ö†Ô∏è **Validate manday calculations** (hours vs mandays)

---

## Recommended Upload Order

```
1. CONTRACTORS (master data)
   ‚Üì
2. EMPLOYEES (master data)
   ‚Üì
3. PUNCHRECORD REPORT (transaction data)
   ‚Üì
4. ARC SUMMARY (aggregated data)
   ‚Üì
5. OVERTIME / PARTIAL DAY / REGULARIZATION (exception data)
```

This order ensures:
- Foreign keys exist before transactions
- Master data is complete
- Relationships are maintained

---

## Summary

### ‚úÖ **Similarities Found:**
1. All files share **EP NO, PUNCHDATE, CONTRACTOR CODE** - perfect for linking
2. All files have **employee and contractor information**
3. All files cover **same date range** (Dec 2025)
4. All files use **same sector** (Polyester)

### ‚ö†Ô∏è **Differences Found:**
1. **Column naming inconsistency** (epNo vs EP NO)
2. **Different purposes** (summary vs detail vs exceptions)
3. **Different record counts** (19 to 25,071 rows)
4. **Different approval workflows** (some have EIC, some have Admin)

### üéØ **Integration Strategy:**
1. Create **normalized database schema**
2. Build **file upload interface** with auto-detection
3. Implement **data validation** before import
4. Create **user dashboards** based on role
5. Build **approval workflows** for exceptions
6. Generate **reports** combining all data sources

---

**Ready for web application integration!** üöÄ
